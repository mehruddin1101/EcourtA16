<p-steps [(activeIndex)]="currentStep" [model]="steps" (onStepChange)="onStepChange($event)" responsive="true" class="responsive-steps">
</p-steps>


<div class="container m-auto" style="width: fit-content; margin: auto; margin-top: 4rem;">
    <div class="card p-2">
        <ng-container *ngIf="currentStep === 0">
            <form [formGroup]="registerFormStep1" (ngSubmit)="onSubmitStep1()">
                <div class="p-col w-full p-md-3 p-sm-2  p-d-flex p-flex-column p-ai-center p-jc-center gap-3 pt-5 ">
                    
                    <div class="row">
                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <label class="w-6rem">First Name:</label>
                            <div class="p-inputgroup">
                                <span class="p-inputgroup-addon">
                                    <i class="pi pi-user"></i>
                                </span>
                                <input pInputText type="text" class="p-inputtext" formControlName="firstName" />
                            </div>
                            <small
                                *ngIf="registerFormStep1.get('firstName').hasError('required') && (registerFormStep1.get('firstName').touched || submitted)"
                                class="p-error">First Name is required</small>
                        </div>

                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <label class="w-6rem">Last Name:</label>
                            <div class="p-inputgroup">
                                <span class="p-inputgroup-addon">
                                    <i class="pi pi-user"></i>
                                </span>
                                <input pInputText type="text" class="p-inputtext" formControlName="lastName" />
                            </div>
                            <small
                                *ngIf="registerFormStep1.get('lastName').hasError('required') && (registerFormStep1.get('lastName').touched || submitted)"
                                class="p-error">Last Name is required</small>
                        </div>
                    </div>
                   

                    <div class="p-d-flex p-flex-wrap p-jc-center p-ai-center gap-0 row">

                        
                        <div class="p-field col-lg-4 col-md-4 col-sm-12 gap-0">
                            <label class="w-6rem">State:</label>
                            <div class="p-inputgroup">
                                <span class="p-inputgroup-addon">
                                    <i class="pi pi-globe"></i>
                                </span>
                                <p-dropdown [options]="stateOptions" formControlName="state"
                                    class="p-inputgroup"></p-dropdown>
                            </div>
                            <small
                                *ngIf="registerFormStep1.get('state').hasError('required') && (registerFormStep1.get('state').touched || submitted)"
                                class="p-error">State is required</small>
                        </div>


                        
                        <div class="p-field col-lg-4 col-md-4 col-sm-12 gap-0">
                            <label class="w-6rem">District:</label>
                            <div class="p-inputgroup">
                                <span class="p-inputgroup-addon">
                                    <i class="pi pi-globe"></i>
                                </span>
                                <p-dropdown [options]="districtOptions" formControlName="district"
                                    class="p-inputgroup"></p-dropdown>
                            </div>
                            <small
                                *ngIf="registerFormStep1.get('district').hasError('required') && (registerFormStep1.get('district').touched || submitted)"
                                class="p-error">District is required</small>
                        </div>
                        <div class="p-field col-lg-4 col-md-4 col-sm-12 gap-0">
                            <label class="w-6rem">City:</label>
                            <div class="p-inputgroup">
                                <span class="p-inputgroup-addon">
                                    <i class="pi pi-globe"></i>
                                </span>
                                <p-dropdown [options]="cityOptions" formControlName="city"
                                    class="p-inputgroup"></p-dropdown>
                            </div>
                            <small
                                *ngIf="registerFormStep1.get('city').hasError('required') && (registerFormStep1.get('city').touched || submitted)"
                                class="p-error">city is required</small>
                        </div>
                    </div>

                   
                    <div class="p-field p-d-flex p-flex-wrap p-jc-center p-ai-center gap-2">
                        <label class="w-6rem">Address:</label>
                        <div class="p-inputgroup">
                            <span class="p-inputgroup-addon">
                                <i class="pi pi-map-marker"></i>
                            </span>
                            <textarea pInputTextarea rows="3" class="p-inputtextarea" formControlName="address"
                                style="width: 100%;"></textarea>
                        </div>
                        <small
                            *ngIf="registerFormStep1.get('address').hasError('required') && (registerFormStep1.get('address').touched || submitted)"
                            class="p-error">Address is required</small>
                    </div>

                    <div class="row">

                        
                        <div class="p-field col-lg-6 col-md-6 col-sm-12 gap-2 ">
                            <label class="w-6rem">Email:</label>
                            <div class="p-inputgroup">
                                <span class="p-inputgroup-addon">
                                    <i class="pi pi-envelope"></i>
                                </span>
                                <input pInputText type="email" class="p-inputtext" formControlName="email" />
                            </div>
                            <small
                                *ngIf="registerFormStep1.get('email').hasError('required') && (registerFormStep1.get('email').touched || submitted)"
                                class="p-error">Email is required</small>
                            <small
                                *ngIf="registerFormStep1.get('email').hasError('email') && (registerFormStep1.get('email').touched || submitted)"
                                class="p-error">Invalid email format</small>
                        </div>




                        
                        <div class="p-field col-lg-6 col-md-6 col-sm-12 gap-2 ">
                            <label class="w-6rem">Category:</label>
                            <div class="p-inputgroup">
                                <span class="p-inputgroup-addon">
                                    <i class="pi pi-star"></i>
                                </span>
                                <p-dropdown [options]="categoryOptions" formControlName="category"
                                    class="p-inputgroup"></p-dropdown>
                            </div>
                            <small
                                *ngIf="registerFormStep1.get('category').hasError('required') && (registerFormStep1.get('category').touched || submitted)"
                                class="p-error">Category is required</small>
                        </div>

                    </div>
                    
                    <div class="p-field p-d-flex p-flex-wrap p-jc-center p-ai-center gap-2">
                        <label class="w-6rem">Profession:</label>
                        <div class="p-inputgroup">

                            <input pInputText type="text" class="p-inputtext" formControlName="profession" />
                        </div>
                        <small
                            *ngIf="registerFormStep1.get('profession').hasError('required') && (registerFormStep1.get('profession').touched || submitted)"
                            class="p-error">Profession is required</small>
                    </div>
                    
                    <div class="p-field p-d-flex p-flex-wrap p-jc-center p-ai-center gap-2">
                        <label class="w-6rem">Mobile:</label>
                        <div class="p-inputgroup ">
                            <span class="p-inputgroup-addon">
                                <i class="pi pi-mobile"></i>
                            </span>
                            <input pInputText type="text" class="p-inputtext" formControlName="mobileNumber" />
                        </div>
                        <small
                            *ngIf="registerFormStep1.get('mobileNumber').hasError('required') && (registerFormStep1.get('mobileNumber').touched || submitted)"
                            class="p-error">Mobile Number is required</small>
                        <small
                            *ngIf="registerFormStep1.get('mobileNumber').hasError('pattern') && (registerFormStep1.get('mobileNumber').touched || submitted)"
                            class="p-error">Invalid mobile number format</small>
                    </div>

                   
                    <div class="mt-3" style="margin-top: 1rem;">
                        <p-button label="Register" icon="pi pi-check" styleClass="w-12rem mx-auto"
                            type="submit"></p-button>
                    </div>
                </div>
            </form>
        </ng-container>

        <ng-container *ngIf="currentStep === 1">
            <form [formGroup]="registerFormStep2" (ngSubmit)="onSubmitStep2()">
                <div class="p-d-flex p-flex-wrap p-jc-center p-ai-center gap-2">
        
                    <label class="w-6rem">Registered Number:</label>
                    <div class="p-inputgroup">
        
                        <span class="p-inputgroup-addon">
                            <i class="pi pi-mobile"></i>
                        </span>
        
                        <input pInputText type="text" class="p-inputtext" formControlName="mobileNumber" />
                        <button  pButton type="button" label="Send OTP"
                        class="p-button-success" [disabled]="otpsend" (click)="generateOtp()" ></button>

                    </div>
        
                    <div style="margin-top: 15px;" *ngIf="otpsend">
                        <label class="w-6rem">OTP:</label>
                        <div class="p-inputgroup">
        
                            <span class="p-inputgroup-addon">
                                <i class="pi pi-key"></i>
                            </span>
                            <input pInputText  type="text" class="p-inputtext" formControlName="otp" />
                            <button  pButton type="button" (click)="verifyOtp()" label="verify OTP"
                            class="p-button-success" ></button>
                           
                        </div>
                        <small
                            *ngIf="registerFormStep2.get('otp').hasError('required') && (registerFormStep2.get('otp').touched || submitted)"
                            class="p-error">OTP is required</small>
        
                    </div>
        
                </div>
        
                <div class="mt-3" style="margin-top: 1rem;">
                    <p-button label="Back" class="me-2" icon="pi pi-arrow-left" styleClass="w-12rem mx-auto me-1" type="button"
                        (click)="onStepChange(0)"></p-button>
                    <p-button label="Next" icon="pi pi-arrow-right"[disabled]="!otpVerified" styleClass="w-12rem mx-auto" type="button"
                        (click)="onSubmitStep2()"></p-button>
                </div>
            </form>
        </ng-container>
        

        <ng-container *ngIf="currentStep === 2">
            <form [formGroup]="registerFormStep3" (ngSubmit)="onSubmitStep3()">
                <div class="p-d-flex p-flex-wrap p-jc-center p-ai-center gap-2">
                    <label class="w-6rem">Username:</label>
                    <div class="p-inputgroup">
                        <span class="p-inputgroup-addon">
                            <i class="pi pi-user"></i>
                        </span>
                        
                        <input pInputText type="text" class="p-inputtext" formControlName="username" />
                    </div>
                    <small
                        *ngIf="registerFormStep3.get('username').hasError('required') && (registerFormStep3.get('username').touched || submitted)"
                        class="p-error">Username is required</small>
                </div>

                <div class="p-d-flex p-flex-wrap p-jc-center p-ai-center gap-2">
                    <label class="w-6rem">Password:</label>
                    <div class="p-inputgroup">
                        <span class="p-inputgroup-addon">
                            <i class="pi pi-lock"></i>
                        </span>
                        <input pInputText type="password" class="p-inputtext" formControlName="password" />
                    </div>
                    <small
                        *ngIf="registerFormStep3.get('password').hasError('required') && (registerFormStep3.get('password').touched || submitted)"
                        class="p-error">Password is required</small>
                </div>

                <div class="mt-3" style="margin-top: 1rem;">
                    <p-button label="Return" class="me-2" icon="pi pi-arrow-left" styleClass="w-12rem mx-auto" type="button"
                        (click)="onStepChange(0)"></p-button>
                    <p-button label="Register" icon="pi pi-check" styleClass="w-12rem mx-auto" type="submit"></p-button>
                </div>
            </form>
        </ng-container>
    </div>
</div>